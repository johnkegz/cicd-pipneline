name: CD Pipeline

on:
  workflow_run:
    workflows: ["CI pipeline"]
    types:
      - completed

jobs:

  build:

    runs-on: self-hosted

    steps:
    - name: Pull Docker image
      run: sudo docker pull johnkegz/cicd_pipneline:latest
    - name: Delete Docker container
      run: docker rm -f cicd_pipneline || true
    - name: Run Docker Container
      run: sudo docker run -d -p 8080:8080 johnkegz/cicd_pipneline:latest

      # env:
      #     DOCKER_USERNAME: ${{secrets.DOCKER_USERNAME}}
      #     DOCKER_PASSWORD: ${{secrets.DOCKER_PASSWORD}}
    #   run: docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD
    # - name: Build the Docker image
    #   run: docker build -t johnkegz/cicd_pipneline:latest .
    # - name: List docker images
    #   run: docker images
    # - name: Push to Dockerhub
    #   run: docker push johnkegz/cicd_pipneline:latest
